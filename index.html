<!doctype html>
<html lang="zh-Hant-TW">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="favicon/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      type="image/png"
      href="favicon/favicon-96x96.png"
      sizes="96x96"
    />
    <link rel="icon" type="image/svg+xml" href="favicon/favicon.svg" />
    <link rel="shortcut icon" href="favicon/favicon.ico" />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="favicon/apple-touch-icon.png"
    />
    <meta name="apple-mobile-web-app-title" content="MemeDam" />
    <!-- 使用非阻塞式載入 site.webmanifest，避免在 OAuth 流程中造成問題 -->
    <link
      rel="manifest"
      href="favicon/site.webmanifest"
      crossorigin="anonymous"
    />
    <title>迷因典 MemeDam</title>
    <meta
      name="description"
      content="迷因典 MemeDam：探索、分享、收藏最新最熱門的迷因內容。"
    />
    <meta name="robots" content="index,follow" />
    <link rel="canonical" href="https://www.memedam.com/" />

    <!-- 字體 -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,100..900;1,100..900&family=Noto+Sans+TC:wght@100..900&display=swap"
      rel="stylesheet"
    />

    <!-- 添加 OAuth 流程優化腳本 -->
    <script>
      // 防止在 OAuth 流程中自動載入不必要的資源
      if (
        window.location.search.includes('code=') ||
        window.location.search.includes('state=')
      ) {
        // 在 OAuth 回調頁面中，延遲載入非關鍵資源
        document.addEventListener('DOMContentLoaded', function () {
          // 延遲載入 webmanifest
          setTimeout(function () {
            const manifestLink = document.querySelector('link[rel="manifest"]')
            if (manifestLink) {
              manifestLink.href = manifestLink.href
            }
          }, 1000)
        })
      }
    </script>

    <!-- 預載入 Logo 圖片 - 僅預載入當前主題的圖片 -->
    <script>
      // 根據當前主題預載入對應的 Logo
      ;(function () {
        const isDark =
          document.documentElement.classList.contains('dark') ||
          window.matchMedia('(prefers-color-scheme: dark)').matches

        const logoUrl = isDark
          ? 'https://res.cloudinary.com/dkhexh4fp/image/upload/v1756045061/memedam-f-bw-light_ne9fhd.png'
          : 'https://res.cloudinary.com/dkhexh4fp/image/upload/v1756045061/memedam-f-bw-dark_saeqez.png'

        const link = document.createElement('link')
        link.rel = 'preload'
        link.as = 'image'
        link.href = logoUrl
        link.type = 'image/png'
        document.head.appendChild(link)
      })()
    </script>

    <!-- Google AdSense -->
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9007041139144014"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
